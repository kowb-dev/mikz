╔═══════════════════════════════════════════════════════════════════════╗
║                   ИСПРАВЛЕНИЯ v1.4.0 - КРАТКАЯ ИНСТРУКЦИЯ            ║
╚═══════════════════════════════════════════════════════════════════════╝

Автор: KB | Сайт: https://kowb.ru | Дата: 2024

───────────────────────────────────────────────────────────────────────

ЧТО БЫЛО ИСПРАВЛЕНО:
══════════════════════

1. SINGLE PRODUCT PAGE:
   ✓ Убрано дублирование уведомления "добавлено в избранное"
   ✓ Работает уведомление "добавлено в корзину"
   ✓ Счетчик корзины обновляется при удалении товара

2. SHOP И CAN PAGES:
   ✓ Работают уведомления "добавлено в избранное"
   ✓ Обновляется счетчик избранного

───────────────────────────────────────────────────────────────────────

ИЗМЕНЕННЫЕ ФАЙЛЫ:
═════════════════

JavaScript (обновлены до v1.4.0):
  → /assets/js/notifications.js
  → /assets/js/action-badges.js

PHP (обновлены до v1.4.0):
  → /inc/features/notifications.php
  → /inc/features/action-badges.php
  → /inc/yith-wishlist-fixes.php (НОВЫЙ)
  → /functions.php (v1.1.0)

───────────────────────────────────────────────────────────────────────

КЛЮЧЕВЫЕ ИЗМЕНЕНИЯ:
═══════════════════

notifications.js:
  • Удалены строки 103-122 (дублирующиеся обработчики wishlist)
  • Увеличен debounce: 1000ms → 1500ms
  • Улучшена обработка события added_to_wishlist
  • Файл сократился: 245 → 210 строк (-35 строк)

action-badges.js:
  • Добавлены множественные проверки обновления счетчиков
  • Wishlist: две проверки (100ms + 500ms)
  • Compare: две проверки (100ms + 500ms)
  • Cart remove: три проверки (100ms, 500ms, 1000ms)
  • Добавлен обработчик wc_cart_button_updated

yith-wishlist-fixes.php (НОВЫЙ):
  • AJAX обновление счетчика wishlist
  • Локализация YITH скриптов
  • Принудительное включение AJAX режима
  • Подавление стандартных уведомлений YITH

───────────────────────────────────────────────────────────────────────

ПОСЛЕ ОБНОВЛЕНИЯ:
═════════════════

1. Очистите кеш браузера (Ctrl+F5 или Cmd+Shift+R)

2. Проверьте работу на странице товара:
   - Добавьте товар в корзину → должно появиться уведомление
   - Добавьте товар в избранное → уведомление появляется ОДИН раз
   - Счетчики должны обновиться

3. Проверьте работу на странице /shop:
   - Добавьте товар в избранное → должно появиться уведомление
   - Счетчик избранного должен обновиться

4. Проверьте корзину:
   - Удалите товар → счетчик должен обновиться

───────────────────────────────────────────────────────────────────────

ТЕХНИЧЕСКАЯ ИНФОРМАЦИЯ:
═══════════════════════

Версии:
  • Theme version: 1.0.9 → 1.1.0
  • Notifications: 1.3.0 → 1.4.0
  • Action Badges: 1.3.0 → 1.4.0
  • YITH Wishlist Fixes: новый модуль v1.0.0

Совместимость:
  • WordPress: 5.8+
  • WooCommerce: 5.0+
  • YITH Wishlist: 3.0+
  • YITH Compare: 2.0+
  • PHP: 7.4+
  • Shoptimizer Theme: latest

───────────────────────────────────────────────────────────────────────

ДОКУМЕНТАЦИЯ:
═════════════

Полная документация:
  📄 CHANGELOG_v1.4.0.md - детальное описание всех изменений
  📄 FIXES_WISHLIST_CART.md - краткое описание исправлений
  📄 SUMMARY_FIXES.txt - краткая сводка

───────────────────────────────────────────────────────────────────────

ОТКАТ ИЗМЕНЕНИЙ:
════════════════

Если что-то пошло не так:

1. Восстановите файлы из резервной копии
2. Или измените версии на 1.3.0
3. Удалите /inc/yith-wishlist-fixes.php
4. Уберите строку 68 из functions.php

───────────────────────────────────────────────────────────────────────

КОНТАКТЫ:
═════════

Вопросы и поддержка:
  Сайт: https://kowb.ru
  Автор: KB

╔═══════════════════════════════════════════════════════════════════════╗
║                              КОНЕЦ ДОКУМЕНТА                          ║
╚═══════════════════════════════════════════════════════════════════════╝
