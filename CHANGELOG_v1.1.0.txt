═══════════════════════════════════════════════════════════════════
  ИСПРАВЛЕНИЕ СЧЕТЧИКОВ И УВЕДОМЛЕНИЙ v1.1.0
  Дата: Декабрь 2024
  Автор: KB | https://kowb.ru
═══════════════════════════════════════════════════════════════════

ИСПРАВЛЕННЫЕ ПРОБЛЕМЫ:
─────────────────────────────────────────────────────────────────

✓ Счетчик избранного теперь обновляется при добавлении товаров
✓ Счетчики корректно сбрасываются при очистке корзины/сравнения
✓ Уведомления работают для всех действий (корзина, сравнение, избранное)
✓ Уведомления корректно отображаются на страницах /shop и категорий
✓ Добавлена поддержка мобильных счетчиков в нижней навигации

─────────────────────────────────────────────────────────────────
ИЗМЕНЁННЫЕ ФАЙЛЫ:
─────────────────────────────────────────────────────────────────

1. assets/js/action-badges.js (v1.0.8 → v1.1.0)
   • Добавлены события wishlist: added_to_wishlist, removed_from_wishlist
   • Добавлены события compare: yith_woocompare_product_added, yith_woocompare_product_removed
   • Добавлена обработка очистки корзины и сравнения
   • Добавлены события: wc_fragments_refreshed, wc_fragments_loaded
   • Новый метод: updateMobileBadge() для мобильной навигации
   • Уменьшена задержка обновления счетчиков: 1200ms → 500ms

2. assets/js/notifications.js (v1.0.5 → v1.1.0)
   • Улучшена обработка событий на страницах /shop и категорий
   • Добавлены обработчики клика для кнопок (add_to_cart_button, compare, wishlist)
   • Улучшен getProductName() - теперь извлекает название из DOM перед AJAX
   • Добавлена поддержка альтернативных атрибутов (data-product-id, data-product_id)
   • Добавлено событие yith_woocompare_product_removed

3. inc/features/action-badges.php (v1.0.2 → v1.1.0)
   • Обновлена версия скрипта до 1.1.0

4. inc/features/notifications.php (v1.0.1 → v1.1.0)
   • Обновлены версии CSS и JS до 1.1.0

5. inc/helpers/class-mkx-mobile-nav-walker.php (v1.0.0 → v1.1.0)
   • Добавлено автоматическое отображение счетчиков в мобильной навигации
   • Поддержка счетчиков: cart, wishlist, compare
   • Классы: mkx-mobile-nav-cart-count, mkx-mobile-nav-wishlist-count, mkx-mobile-nav-compare-count

─────────────────────────────────────────────────────────────────
ТЕХНИЧЕСКИЕ ДЕТАЛИ:
─────────────────────────────────────────────────────────────────

НОВЫЕ СОБЫТИЯ В action-badges.js:
  → added_to_wishlist - обновление счетчика избранного
  → removed_from_wishlist - обновление при удалении из избранного
  → yith_woocompare_product_added - обновление счетчика сравнения
  → yith_woocompare_product_removed - обновление при удалении из сравнения
  → wc_fragments_refreshed - синхронизация с WooCommerce
  → wc_fragments_loaded - синхронизация после загрузки фрагментов

НОВЫЕ ОБРАБОТЧИКИ КЛИКА В notifications.js:
  → .add_to_cart_button - уведомления при добавлении в корзину
  → a.compare:not(.added) - уведомления при добавлении к сравнению
  → .yith-wcwl-add-button a:not(.added) - уведомления при добавлении в избранное

ОБРАБОТКА ОЧИСТКИ:
  → .woocommerce-cart .remove - сброс счетчика корзины
  → a.clear_all, .yith-woocompare-widget a.clear-all - сброс счетчика сравнения

─────────────────────────────────────────────────────────────────
ТЕСТИРОВАНИЕ:
─────────────────────────────────────────────────────────────────

□ Добавление товара в избранное на странице товара
□ Добавление товара в избранное на странице /shop
□ Добавление товара в избранное в категории
□ Удаление товара из избранного
□ Добавление товара в корзину на странице товара
□ Добавление товара в корзину на странице /shop
□ Добавление товара в корзину в категории
□ Очистка корзины (удаление всех товаров)
□ Добавление товара к сравнению на странице товара
□ Добавление товара к сравнению на странице /shop
□ Добавление товара к сравнению в категории
□ Очистка списка сравнения
□ Проверка счетчиков в мобильной навигации
□ Проверка счетчиков в десктоп навигации

─────────────────────────────────────────────────────────────────
СОВМЕСТИМОСТЬ:
─────────────────────────────────────────────────────────────────

✓ WordPress 6.x
✓ WooCommerce 8.x+
✓ YITH WooCommerce Wishlist Premium
✓ YITH WooCommerce Compare Premium
✓ Shoptimizer Theme
✓ jQuery 3.x
✓ Все современные браузеры

─────────────────────────────────────────────────────────────────

ПРИМЕЧАНИЕ: После обновления файлов рекомендуется очистить кеш
браузера (Ctrl+F5) и кеш плагинов WordPress для корректной работы.

═══════════════════════════════════════════════════════════════════
