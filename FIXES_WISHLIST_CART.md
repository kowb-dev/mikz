# Исправления уведомлений и счетчиков (v1.4.0)

## Проблемы, которые были исправлены:

### 1. Single Product Page
- **Решено:** Дублирование уведомлений о добавлении в избранное
- **Решено:** Корректная работа уведомления о добавлении в корзину
- **Решено:** Обновление счетчика корзины при удалении товара

### 2. Shop и Can Pages
- **Решено:** Уведомления о добавлении в избранное теперь работают
- **Решено:** Счетчик избранного обновляется корректно

## Внесенные изменения:

### notifications.js (v1.4.0)
- Удален дублирующийся обработчик клика для wishlist кнопок
- Улучшена логика debounce (увеличено время с 1000ms до 1500ms)
- Добавлена проверка на наличие productId перед обработкой событий
- Упрощена обработка событий YITH (удалены резервные click обработчики)

### action-badges.js (v1.4.0)
- Добавлены множественные проверки обновления счетчиков с разными задержками
- Добавлен новый обработчик события 'wc_cart_button_updated'
- Улучшена обработка удаления товаров из корзины (3 проверки: 100ms, 500ms, 1000ms)
- Оптимизированы задержки для wishlist событий (100ms + 500ms вместо одной задержки 300ms)

### yith-wishlist-fixes.php (новый файл)
- Добавлена дополнительная AJAX поддержка для YITH Wishlist
- Включена принудительная поддержка AJAX режима
- Отключены стандартные сообщения YITH (используются кастомные)
- Добавлена локализация для YITH скриптов

## Технические детали:

- Версия notifications: 1.3.0 → 1.4.0
- Версия action-badges: 1.3.0 → 1.4.0
- Версия functions.php: 1.0.9 → 1.1.0

## Результат:

✅ Уведомления работают корректно на всех типах страниц
✅ Счетчики обновляются моментально после любых действий
✅ Нет дублирования уведомлений
✅ Корректная работа при удалении товаров из корзины
